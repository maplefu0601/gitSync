
<html>
<head>
	<title>GDC DOCS MANAGEMENT</title>
</head>
<body>
	<h1>GDC DOCS MANAGEMENT</h1>
	
	<div>
		<label><input type='checkbox' id='chkBoxGitPull'>Monitor Git Changes</label><br>
		<label><input type='checkbox' id='chkBoxCreateHtml'>Automatically Generate Web Site</label><br>
		<label><input type='checkbox' id='chkboxCreatePdf'>Automatically Convert to Pdf</label><br><br>
	</div>
	<div>
		<span>repository name:</span><input id='repoName' name='reponame' value='test-gdcdocs'/>
		<button id='getCode'>Get MKDOCS</button>
		<button id='createHtml'>Generate HTML</button>
		<button id='toPdf'>Convert To PDF</button>
	</div>
	<br><br>
	<div>
		<a id='idLinkWeb' href='http://www.google.ca'>Demo Web</a><br>
		<a id='idLinkPdf' href='http://www.google.ca'>Get PDF</a><br>
	</div>

	<div id='log'>
	</div>
	<style>
		#log {
			position: fixed;
			bottom:0px;
			background-color:#aaaaaa;
			width:100%;
			height:300px;
			scroll: auto;
		}
	</style>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	    <script type="text/javascript">
			var URL = 'http://54.69.251.157:6600/';
		    $(document).ready(function() {

				$('#getCode').click(function() {
					var name = ($('#repoName')[0].value);
					//alert(name);

					$.ajax({
						url: URL + 'gitchanged?name='+name,
						method: 'get'
					}).done(function(msg) {
						console.log('get git changed---'+JSON.stringify(msg));
						$('#log').html(JSON.stringify(msg));
					}).fail(function(msg) {
						console.log('fail to get git changed ======'+msg);
						$('#log').html(JSON.stringify(msg));
					});

				});

				$('#createHtml').click(function() {
					var name = ($('#repoName')[0].value);
					//alert(name);

					$.ajax({
						url: URL + 'generateHtml?name='+name,
						method: 'get'
					}).done(function(msg) {
						console.log('get git changed---'+JSON.stringify(msg));
						$('#log').html(JSON.stringify(msg));
					}).fail(function(msg) {
						console.log('fail to get git changed ======'+msg);
						$('#log').html(JSON.stringify(msg));
					});
				});
				
				$('#toPdf').click(function() {
					var name = ($('#repoName')[0].value);
					//alert(name);

					$.ajax({
						url: URL + 'markdown?name='+name,
						method: 'get'
					}).done(function(msg) {
						console.log('get git changed---'+JSON.stringify(msg));
						$('#log').html(JSON.stringify(msg));
					}).fail(function(msg) {
						console.log('fail to get git changed ======'+msg);
						$('#log').html(JSON.stringify(msg));
					});
				});

				//change if need auto pull data when repository changed
				$('#chkBoxGitPull').click(function() {
					var repoName = ($('#repoName')[0].value);
					if(repoName.length === 0) {
						alert('Need repository name.');
						return;
					}
					var checked = $('#chkBoxGitPull').is(':checked');
					//add resopitory name to the list
					var data = {config: {}};
					//config:{'test-gdcdocs':true}
					data.config[repoName] = checked;

					saveConfig(JSON.stringify(data));
				});

				//value = {pdf:{destPath:'/home/ubuntu/test'}}
				function saveConfig(value) {
					
					
					$.ajax({
						url: URL + 'updateConfig?value='+value,
						method: 'get'
					}).done(function(msg) {
						$('#log').html(JSON.stringify(msg));
					}).fail(function(msg) {
						$('#log').html(JSON.stringify(msg));
					});
					
				}

				$('#chkBoxCreateHtml').click(function() {
					var checked = $('#chkBoxCreateHtml').is(':checked');
					var data = {config:{autoGenWebSite: checked}};

					saveConfig(JSON.stringify(data));

				});
				
				$('#chkBoxCreatePdf').click(function() {
					var checked = $('#chkBoxCreatePdf').is(':checked');
					var data = {config:{autoCreatePdf: checked}};

					saveConfig(JSON.stringify(data));
				});
			})
		</script>
</body>
</html>




